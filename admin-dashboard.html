<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Dashboard - FIK STORE</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getFirestore, collection, getDocs, addDoc, updateDoc, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";const firebaseConfig = {
  apiKey: "AIzaSyC5aNVM7c2eUd5P-0k8jZCKhgBNWFcKO-c",
  authDomain: "fikstore-id.firebaseapp.com",
  projectId: "fikstore-id",
  storageBucket: "fikstore-id.appspot.com",
  messagingSenderId: "323293742570",
  appId: "1:323293742570:web:5de4906939fd19d6ec9e93"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const productsCol = collection(db, "products");

const productList = document.getElementById("product-list");
const form = document.getElementById("add-product-form");

async function loadProducts() {
  productList.innerHTML = "";
  const snapshot = await getDocs(productsCol);
  snapshot.forEach(docSnap => {
    const data = docSnap.data();
    const div = document.createElement("div");
    div.innerHTML = `
      <strong>${data.name}</strong><br>
      ${data.description}<br>
      Harga: Rp${data.price} ${data.discount ? `(Diskon: Rp${data.discount})` : ""}<br>
      <img src="${data.imageUrl}" width="100"><br>
      <button onclick="editProduct('${docSnap.id}', '${data.name}', '${data.description}', ${data.price}, ${data.discount ?? 0}, '${data.imageUrl}')">Edit</button>
      <button onclick="deleteProduct('${docSnap.id}')">Hapus</button>
      <hr>
    `;
    productList.appendChild(div);
  });
}

window.editProduct = function(id, name, description, price, discount, imageUrl) {
  document.getElementById("product-id").value = id;
  form.name.value = name;
  form.description.value = description;
  form.price.value = price;
  form.discount.value = discount || "";
  form.imageUrl.value = imageUrl;
  document.getElementById("submit-btn").innerText = "Update Produk";
}

window.deleteProduct = async function(id) {
  if (confirm("Yakin ingin menghapus produk?")) {
    await deleteDoc(doc(productsCol, id));
    loadProducts();
  }
}

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  const id = document.getElementById("product-id").value;
  const data = {
    name: form.name.value,
    description: form.description.value,
    price: Number(form.price.value),
    discount: form.discount.value ? Number(form.discount.value) : null,
    imageUrl: form.imageUrl.value,
  };
  if (id) {
    await updateDoc(doc(productsCol, id), data);
  } else {
    await addDoc(productsCol, data);
  }
  form.reset();
  document.getElementById("submit-btn").innerText = "Tambah Produk";
  loadProducts();
});

loadProducts();

  </script>
</head>
<body>
  <h1>Dashboard Admin - FIK STORE</h1>
  <form id="add-product-form">
    <input type="hidden" id="product-id">
    <input type="text" name="name" placeholder="Nama Produk" required><br>
    <textarea name="description" placeholder="Deskripsi" required></textarea><br>
    <input type="number" name="price" placeholder="Harga" required><br>
    <input type="number" name="discount" placeholder="Harga Diskon (Opsional)"><br>
    <input type="text" name="imageUrl" placeholder="Link Gambar (URL)" required><br>
    <button id="submit-btn" type="submit">Tambah Produk</button>
  </form>
  <hr>
  <div id="product-list"></div>
</body>
</html>
